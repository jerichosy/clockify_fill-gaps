# Copilot Instructions for clockify_fill-gaps

- **Purpose**: CLI helper to preview weekly Clockify gaps (local-time corrected) and optionally auto-create filler entries.
- **Entry point**: [clockify_gaps.py](../clockify_gaps.py) only; no packages or tests.
- **Required secrets**: set `CLOCKIFY_KEY` and `CLOCKIFY_WORKSPACE_ID` (loaded via `python-dotenv`). Abort early if missing.
- **Local time**: All logic converts API data to `ZoneInfo("Asia/Manila")`. Adjust `LOCAL_TZ` if changing region; gaps are computed in local minutes-of-day.
- **Workday window**: `WORK_START/WORK_END` minutes (defaults 09:00–18:00). Gaps outside this window are ignored.
- **Description template**: `ENTRY_DESC` is reused for all filler entries.
- **Week selection**: Script prompts for any date (YYYY-MM-DD). It computes the Monday–Sunday window containing that date.
- **Fetch flow**: `get_user_info()` → `get_entries()` (UTC range) → localize via `zoneinfo` → `group_by_local_day()` → `find_gaps()` merges overlaps before finding empty spans.
- **Preview output**: Prints gaps per day as `HH:MM-HH:MM`, or `None` if fully covered.
- **Posting behavior**: After preview, prompts `Create filler entries... (y/N)`. On `y`, reuses project/task/billable from the first entry of each day and posts one filler per gap using `post_time_entry()`.
- **Safety**: `post_time_entry()` is live; remove `print` or add a dry-run flag if you need simulation. Current TODO: lunch breaks are not considered.
- **API endpoints**: Uses Clockify v1 `user`, `time-entries` GET, and `time-entries` POST; headers require `x-api-key`.
- **Inputs parsing**: Dates parsed with `dateutil.parser` for intervals; manual ISO parsing for the prompt.
- **Python version**: Needs 3.9+ for `zoneinfo`.
- **Install & run**:
  - `pip install -r requirements.txt`
  - `python clockify_gaps.py`
- **Modifying gap rules**: Update `find_gaps()` to inject breaks (e.g., lunch) before computing gaps. Keep minutes-based logic and sorted merge behavior intact.
- **Extending entries**: If you need different projects/tasks per day, change the selection of `first_raw` in `preview_week()`; it's currently first entry of that day.
- **Error handling**: Network calls use `raise_for_status()` except POST (prints warning). Add retries or better logging if running unattended.
- **Configuration storage**: `.env` supported via `python-dotenv`; avoid hardcoding keys.
- **Data inspection**: `get_entries()` retains `raw_data`; handy if you need more fields when constructing fillers.
- **Default prompts**: Empty date input defaults to today; non-ISO input falls back to today with a notice.
- **Publishing/CI**: None present; single-file script.
